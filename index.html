<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunar Lander - æœˆé¢ç€é™¸ã‚²ãƒ¼ãƒ </title>
    <style>
        body {
            background-color: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            font-size: 14px;
        }
        
        .terminal {
            background-color: #001100;
            border: 2px solid #00ff00;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            border-radius: 5px;
            box-shadow: 0 0 20px #00ff0050;
        }
        
        .title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff00;
        }
        
        .game-area {
            white-space: pre-line;
            line-height: 1.2;
            margin: 20px 0;
            min-height: 400px;
            display: flex;
            justify-content: space-between;
            align-items: stretch;
        }
        
        .text-display {
            flex: 1;
            margin-right: 20px;
            min-height: 400px;
        }
        
        .visual-display {
            width: 400px;
            height: 400px;
            border: 1px solid #00ff00;
            background-color: #000800;
            position: relative;
        }
        
        canvas {
            width: 100%;
            height: 100%;
            background-color: transparent;
        }
        
        .demo-mode {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            color: #00ff00;
            font-size: 16px;
            font-weight: bold;
            animation: blink 1s infinite;
            background: rgba(0, 0, 0, 0.8);
            padding: 5px 15px;
            border: 1px solid #00ff00;
            border-radius: 3px;
        }
        
        .status {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #00ff00;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background-color: #003300;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 10px 20px;
            margin: 5px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            border-radius: 3px;
        }
        
        button:hover {
            background-color: #004400;
            box-shadow: 0 0 5px #00ff00;
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .blink {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .red { color: #ff0000; }
        .yellow { color: #ffff00; }
        .cyan { color: #00ffff; }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="title">*** LUNAR LANDER ***</div>
        
        <div class="status">
            <div>é«˜åº¦: <span id="altitude">1000</span>m</div>
            <div>é€Ÿåº¦: <span id="velocity">0</span>m/s</div>
            <div>ç‡ƒæ–™: <span id="fuel">100</span>%</div>
        </div>
        
        <div class="game-area">
            <div class="text-display" id="gameArea"></div>
            <div class="visual-display">
                <canvas id="gameCanvas" width="400" height="400"></canvas>
                <div id="demoText" class="demo-mode" style="display: none;">
                    DEMO MODE - ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãƒ—ãƒ¬ã‚¤é–‹å§‹
                </div>
                <div class="controls-info" style="position: absolute; bottom: -50px; left: 0; right: 0; text-align: center; font-size: 12px; color: #00ff00;">
                    æ“ä½œ: [T]ã‚­ãƒ¼ã¾ãŸã¯[æ¨é€²]ãƒœã‚¿ãƒ³ã§ã‚¨ãƒ³ã‚¸ãƒ³ç‚¹ç«<br>
                    ç›®æ¨™: é€Ÿåº¦5m/sä»¥ä¸‹ã§æœˆé¢ã«ç€é™¸
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button id="thrustBtn" onclick="thrust()">æ¨é€² (T)</button>
            <button id="startBtn" onclick="startGame()">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
            <button onclick="showInstructions()">æ“ä½œèª¬æ˜</button>
        </div>
        
        <div id="messages"></div>
    </div>

    <script>
        let gameState = {
            altitude: 1000,
            velocity: 0,
            fuel: 100,
            thrustPower: 0,
            gravity: 1.6, // æœˆã®é‡åŠ›
            gameRunning: false,
            gameOver: false,
            isDemo: false,
            lastUserInput: Date.now(),
            demoActionTimer: 0
        };

        let gameInterval;
        let displayText = '';
        
        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        function initGame() {
            gameState = {
                altitude: 1000,
                velocity: 0,
                fuel: 100,
                thrustPower: 0,
                gravity: 0.8,
                gameRunning: false,
                gameOver: false,
                isDemo: false,
                lastUserInput: Date.now() - 3000, // 3ç§’å‰ã«è¨­å®šã—ã¦ãƒ‡ãƒ¢ãŒæ—©ãé–‹å§‹ã•ã‚Œã‚‹ã‚ˆã†ã«
                demoActionTimer: 0
            };
            updateDisplay();
            showWelcomeMessage();
        }

        function showWelcomeMessage() {
            displayText = `
=== æœˆé¢ç€é™¸ãƒŸãƒƒã‚·ãƒ§ãƒ³ ===

æœˆé¢ç€é™¸èˆ¹ã‚’æ“ç¸¦ã—ã¦å®‰å…¨ã«ç€é™¸ã•ã›ã¦ãã ã•ã„ã€‚

ç›®æ¨™: é€Ÿåº¦5m/sä»¥ä¸‹ã§æœˆé¢ã«ç€é™¸
è­¦å‘Š: é€Ÿåº¦ãŒé€Ÿã™ãã‚‹ã¨å¢œè½ã—ã¾ã™ï¼

ç‡ƒæ–™ã¯é™ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚æ…é‡ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

æº–å‚™ã¯ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ
            `;
            document.getElementById('gameArea').innerHTML = displayText;
        }

        function showInstructions() {
            displayText = `
=== æ“ä½œèª¬æ˜ ===

â€¢ [æ¨é€²]ãƒœã‚¿ãƒ³ã¾ãŸã¯[T]ã‚­ãƒ¼: ã‚¨ãƒ³ã‚¸ãƒ³æ¨é€²
â€¢ ã‚¨ãƒ³ã‚¸ãƒ³ã¯é‡åŠ›ã«é€†ã‚‰ã£ã¦ä¸Šå‘ãã®åŠ›ã‚’ä¸ãˆã¾ã™
â€¢ ç‡ƒæ–™ãŒå°½ãã‚‹ã¨ã‚¨ãƒ³ã‚¸ãƒ³ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“
â€¢ é«˜åº¦0mã§é€Ÿåº¦5m/sä»¥ä¸‹ãªã‚‰ç€é™¸æˆåŠŸ
â€¢ é€Ÿåº¦ãŒé€Ÿã™ãã‚‹ã¨å¢œè½ã—ã¾ã™

ç‰©ç†æ³•å‰‡:
â€¢ é‡åŠ›: 1.6m/sÂ²ï¼ˆæœˆé¢ï¼‰
â€¢ æ¨é€²åŠ›: 3.0m/sÂ²

é ‘å¼µã£ã¦ï¼
            `;
            document.getElementById('gameArea').innerHTML = displayText;
        }

        function startGame() {
            if (gameState.gameRunning) return;
            
            // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã‚’çµ‚äº†
            if (gameState.isDemo) {
                stopDemo();
            }
            
            // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            gameState = {
                altitude: 1000,
                velocity: 0,
                fuel: 100,
                thrustPower: 0,
                gravity: 0.8,  // é‡åŠ›ã‚’åŠåˆ†ã«
                gameRunning: true,
                gameOver: false,
                isDemo: false,
                lastUserInput: Date.now(),
                demoActionTimer: 0
            };
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('startBtn').textContent = 'ã‚²ãƒ¼ãƒ é–‹å§‹';
            
            displayText = `
ãƒŸãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼

æœˆé¢ç€é™¸èˆ¹ãŒé™ä¸‹ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚
ç‡ƒæ–™ã‚’ç®¡ç†ã—ãªãŒã‚‰å®‰å…¨ã«ç€é™¸ã•ã›ã¦ãã ã•ã„ã€‚

            `;
            document.getElementById('gameArea').innerHTML = displayText;
            
            gameInterval = setInterval(gameLoop, 100);
        }

        function thrust() {
            if (!gameState.gameRunning || gameState.gameOver || gameState.fuel <= 0) return;
            
            gameState.thrustPower = 2.5;  // æ¨é€²åŠ›ã‚’å¼·åŒ–
            gameState.fuel = Math.max(0, gameState.fuel - 0.8);  // ç‡ƒæ–™æ¶ˆè²»ã‚’æ¸›ã‚‰ã™
            
            // æ¨é€²ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ä¸€å®šæ™‚é–“ç¶­æŒ
            setTimeout(() => {
                if (gameState.gameRunning && !gameState.gameOver) {
                    gameState.thrustPower = 0;
                }
            }, 300);  // åŠ¹æœæ™‚é–“ã‚’å»¶é•·
        }

        function gameLoop() {
            // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã®ãƒã‚§ãƒƒã‚¯ï¼ˆã‚²ãƒ¼ãƒ é–‹å§‹å‰ã®ã¿ï¼‰
            if (!gameState.gameRunning && !gameState.gameOver) {
                checkDemoMode();
            }
            
            // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ä¸­ã¯AIãŒæ“ä½œ
            if (gameState.isDemo) {
                updateDemoAI();
                
                // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ä¸­ã®ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã¯è‡ªå‹•å†é–‹
                if (gameState.gameOver) {
                    setTimeout(() => {
                        initGame();
                        gameState.isDemo = true;
                        document.getElementById('demoText').style.display = 'block';
                        setTimeout(() => {
                            if (gameState.isDemo) {
                                startGame();
                            }
                        }, 2000);
                    }, 3000);
                }
            }
            
            if (gameState.gameRunning && !gameState.gameOver) {
                // ç‰©ç†è¨ˆç®—ï¼ˆé‡åŠ›ã¯ä¸‹å‘ãã€æ¨é€²ã¯ä¸Šå‘ãï¼‰
                let netAcceleration = gameState.gravity - gameState.thrustPower;
                gameState.velocity += netAcceleration * 0.1;
                gameState.altitude -= gameState.velocity * 0.1;

                updateDisplay();
                updateGameArea();

                // ã‚²ãƒ¼ãƒ çµ‚äº†æ¡ä»¶ãƒã‚§ãƒƒã‚¯
                if (gameState.altitude <= 0) {
                    gameState.altitude = 0;
                    endGame();
                }
            }
            
            // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’æ›´æ–°
            drawGame();
        }

        function updateDisplay() {
            document.getElementById('altitude').textContent = Math.round(gameState.altitude);
            document.getElementById('velocity').textContent = Math.round(gameState.velocity * 10) / 10;
            document.getElementById('fuel').textContent = Math.round(gameState.fuel);
            
            // ç‡ƒæ–™è­¦å‘Š
            if (gameState.fuel < 20) {
                document.getElementById('fuel').className = 'red blink';
            } else if (gameState.fuel < 40) {
                document.getElementById('fuel').className = 'yellow';
            } else {
                document.getElementById('fuel').className = '';
            }
            
            // é€Ÿåº¦è­¦å‘Š
            if (gameState.velocity > 10) {
                document.getElementById('velocity').className = 'red';
            } else if (gameState.velocity > 5) {
                document.getElementById('velocity').className = 'yellow';
            } else {
                document.getElementById('velocity').className = '';
            }
        }

        function updateGameArea() {
            let altitudeBar = '';
            let barLength = 40;
            let position = Math.round((1000 - gameState.altitude) / 1000 * barLength);
            
            for (let i = 0; i < barLength; i++) {
                if (i === position) {
                    altitudeBar += 'â–¼';
                } else if (i === barLength - 1) {
                    altitudeBar += 'â–ˆ'; // æœˆé¢
                } else {
                    altitudeBar += 'Â·';
                }
            }

            let thrustIndicator = gameState.thrustPower > 0 ? 'ğŸ”¥' : '  ';
            let fuelBar = 'â–ˆ'.repeat(Math.round(gameState.fuel / 5));
            
            displayText = `
é«˜åº¦è¨ˆ:
${altitudeBar}

ç€é™¸èˆ¹: ${thrustIndicator}
         â–²
        â–ˆâ–ˆâ–ˆ

ç‡ƒæ–™æ®‹é‡: ${fuelBar}

é€Ÿåº¦: ${gameState.velocity > 0 ? 'â†“' : gameState.velocity < 0 ? 'â†‘' : 'ï¼'} ${Math.abs(gameState.velocity).toFixed(1)} m/s
            `;
            
            document.getElementById('gameArea').innerHTML = displayText;
        }

        function endGame() {
            gameState.gameRunning = false;
            gameState.gameOver = true;
            clearInterval(gameInterval);
            
            let result = '';
            if (Math.abs(gameState.velocity) <= 5) {
                result = `
ğŸŒ™ *** ç€é™¸æˆåŠŸï¼ ***

ç´ æ™´ã‚‰ã—ã„ï¼æœˆé¢ã¸ã®è»Ÿç€é™¸ã«æˆåŠŸã—ã¾ã—ãŸã€‚
ç€é™¸é€Ÿåº¦: ${Math.abs(gameState.velocity).toFixed(1)} m/s
æ®‹ç‡ƒæ–™: ${gameState.fuel}%

æœˆé¢ã§ã®ä»»å‹™ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚

                `;
            } else {
                result = `
ğŸ’¥ *** å¢œè½ ***

ç€é™¸èˆ¹ã¯æœˆé¢ã«æ¿€çªã—ã¾ã—ãŸã€‚
è¡çªé€Ÿåº¦: ${Math.abs(gameState.velocity).toFixed(1)} m/s

æ¬¡å›ã¯ã‚‚ã£ã¨æ…é‡ã«ç€é™¸ã—ã¦ãã ã•ã„ã€‚

                `;
            }
            
            document.getElementById('gameArea').innerHTML = result;
            
            // ãƒœã‚¿ãƒ³ã‚’å³åº§ã«æœ‰åŠ¹åŒ–ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
            document.getElementById('startBtn').disabled = false;
            document.getElementById('startBtn').textContent = 'å†ãƒãƒ£ãƒ¬ãƒ³ã‚¸';
        }

        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã®æç”»å‡¦ç†
        function drawGame() {
            // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢
            ctx.fillStyle = '#000800';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // æœˆé¢ã‚’æç”»
            drawLunarSurface();
            
            // å®‡å®™èˆ¹ã‚’æç”»
            if (gameState.gameRunning || gameState.gameOver) {
                drawSpacecraft();
            }
            
            // æ¨é€²ç‚ã‚’æç”»
            if (gameState.thrustPower > 0 && gameState.gameRunning && !gameState.gameOver) {
                drawThrustFlame();
            }
            
            // æ˜Ÿã‚’æç”»
            drawStars();
        }
        
        function drawLunarSurface() {
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 2;
            
            // æœˆé¢ã®ãƒ©ã‚¤ãƒ³
            ctx.beginPath();
            ctx.moveTo(0, canvas.height - 20);
            for (let x = 0; x < canvas.width; x += 20) {
                const y = canvas.height - 20 + Math.sin(x * 0.05) * 3;
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // æœˆé¢ã®ãƒ†ã‚¯ã‚¹ãƒãƒ£
            ctx.fillStyle = '#003300';
            for (let x = 10; x < canvas.width; x += 30) {
                for (let y = canvas.height - 15; y < canvas.height; y += 5) {
                    if (Math.random() > 0.7) {
                        ctx.fillRect(x, y, 2, 2);
                    }
                }
            }
        }
        
        function drawSpacecraft() {
            // å®‡å®™èˆ¹ã®ä½ç½®ã‚’è¨ˆç®—
            const shipX = canvas.width / 2;
            const shipY = canvas.height - 20 - (gameState.altitude / 1000) * (canvas.height - 40);
            
            ctx.strokeStyle = gameState.isDemo ? '#00ffff' : '#00ff00';
            ctx.fillStyle = gameState.isDemo ? '#004444' : '#003300';
            ctx.lineWidth = 2;
            
            // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã®å…‰ã‚‹åŠ¹æœ
            if (gameState.isDemo) {
                ctx.shadowColor = '#00ffff';
                ctx.shadowBlur = 10;
            }
            
            // å®‡å®™èˆ¹ã®æœ¬ä½“ï¼ˆä¸‰è§’å½¢ï¼‰
            ctx.beginPath();
            ctx.moveTo(shipX, shipY - 10);
            ctx.lineTo(shipX - 8, shipY + 5);
            ctx.lineTo(shipX + 8, shipY + 5);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // ç€é™¸è„š
            ctx.beginPath();
            ctx.moveTo(shipX - 6, shipY + 5);
            ctx.lineTo(shipX - 10, shipY + 12);
            ctx.moveTo(shipX + 6, shipY + 5);
            ctx.lineTo(shipX + 10, shipY + 12);
            ctx.stroke();
            
            // ã‚·ãƒ£ãƒ‰ã‚¦ã‚’ãƒªã‚»ãƒƒãƒˆ
            ctx.shadowBlur = 0;
        }
        
        function drawThrustFlame() {
            const shipX = canvas.width / 2;
            const shipY = canvas.height - 20 - (gameState.altitude / 1000) * (canvas.height - 40);
            
            // ç‚ã®è‰²ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«å¤‰åŒ–
            const colors = ['#ff6600', '#ff3300', '#ffff00'];
            const flameColor = colors[Math.floor(Math.random() * colors.length)];
            
            ctx.strokeStyle = flameColor;
            ctx.fillStyle = flameColor;
            ctx.lineWidth = 2;
            
            // ç‚ã®å½¢çŠ¶ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«å¤‰åŒ–
            const flameHeight = 15 + Math.random() * 10;
            const flameWidth = 4 + Math.random() * 4;
            
            ctx.beginPath();
            ctx.moveTo(shipX, shipY + 5);
            ctx.lineTo(shipX - flameWidth, shipY + flameHeight);
            ctx.lineTo(shipX + flameWidth, shipY + flameHeight);
            ctx.closePath();
            ctx.fill();
        }
        
        function drawStars() {
            ctx.fillStyle = '#00ff00';
            // å›ºå®šã®æ˜Ÿã®ä½ç½®
            const stars = [
                {x: 50, y: 50}, {x: 120, y: 30}, {x: 200, y: 70},
                {x: 280, y: 40}, {x: 350, y: 60}, {x: 80, y: 100},
                {x: 300, y: 120}, {x: 150, y: 90}, {x: 320, y: 80}
            ];
            
            stars.forEach(star => {
                if (Math.random() > 0.3) { // æ˜Ÿã®ç‚¹æ»…
                    ctx.fillRect(star.x, star.y, 1, 1);
                }
            });
        }
        
        // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã®AIåˆ¶å¾¡ï¼ˆæ”¹å–„ç‰ˆï¼‰
        function updateDemoAI() {
            gameState.demoActionTimer++;
            
            if (!gameState.gameRunning || gameState.gameOver) return;
            
            // é«˜åº¦ã¨é€Ÿåº¦ã«åŸºã¥ã„ãŸç²¾å¯†ãªåˆ¶å¾¡
            const altitudeRatio = gameState.altitude / 1000;
            const velocity = gameState.velocity;
            
            // ç›®æ¨™é€Ÿåº¦ã‚’é«˜åº¦ã«å¿œã˜ã¦è¨ˆç®—
            let targetVelocity;
            if (altitudeRatio > 0.5) {
                targetVelocity = 8; // é«˜é«˜åº¦ã§ã¯é€Ÿã‚ã«é™ä¸‹
            } else if (altitudeRatio > 0.3) {
                targetVelocity = 5; // ä¸­é«˜åº¦ã§ã¯ä¸­ç¨‹åº¦
            } else if (altitudeRatio > 0.1) {
                targetVelocity = 3; // ä½é«˜åº¦ã§ã¯æ…é‡ã«
            } else {
                targetVelocity = 1.5; // ç€é™¸ç›´å‰ã¯éå¸¸ã«æ…é‡ã«
            }
            
            // ç€é™¸ç›´å‰ã®ç‰¹åˆ¥åˆ¶å¾¡
            if (gameState.altitude < 50) {
                targetVelocity = Math.min(targetVelocity, 2.5);
            }
            if (gameState.altitude < 20) {
                targetVelocity = Math.min(targetVelocity, 1.5);
            }
            
            // æ¨é€²åˆ¤æ–­ã®æ”¹å–„
            const velocityDiff = velocity - targetVelocity;
            const shouldThrust = velocityDiff > 0.5; // ç›®æ¨™é€Ÿåº¦ã‚ˆã‚Š0.5m/sä»¥ä¸Šé€Ÿã„å ´åˆ
            
            // ç‡ƒæ–™ä¿å­˜ã®ãŸã‚ã®åˆ¶å¾¡
            const fuelThreshold = altitudeRatio * 30 + 10; // é«˜åº¦ã«å¿œã˜ã¦ç‡ƒæ–™ä¿å­˜
            
            // æ¨é€²ã®é »åº¦èª¿æ•´ï¼ˆé€Ÿåº¦å·®ãŒå¤§ãã„ã»ã©é »ç¹ã«ï¼‰
            let thrustInterval;
            if (Math.abs(velocityDiff) > 3) {
                thrustInterval = 3; // ç·Šæ€¥æ™‚ã¯é »ç¹ã«
            } else if (Math.abs(velocityDiff) > 1) {
                thrustInterval = 8; // é€šå¸¸æ™‚
            } else {
                thrustInterval = 15; // ç´°ã‹ã„èª¿æ•´
            }
            
            if (shouldThrust && 
                gameState.fuel > fuelThreshold && 
                gameState.demoActionTimer % thrustInterval === 0) {
                thrust();
            }
        }
        
        // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã®ãƒã‚§ãƒƒã‚¯
        function checkDemoMode() {
            if (gameState.isDemo || gameState.gameRunning) return;
            
            // 5ç§’é–“æ“ä½œãŒãªã‘ã‚Œã°ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰é–‹å§‹
            if (Date.now() - gameState.lastUserInput > 5000) {
                startDemo();
            }
        }
        
        // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰é–‹å§‹
        function startDemo() {
            gameState.isDemo = true;
            gameState.demoActionTimer = 0;
            document.getElementById('demoText').style.display = 'block';
            
            // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
            document.getElementById('startBtn').disabled = false;
            document.getElementById('startBtn').textContent = 'ãƒ—ãƒ¬ã‚¤é–‹å§‹';
            
            // ã‚²ãƒ¼ãƒ ã‚’è‡ªå‹•é–‹å§‹ã—ã€ãƒ‡ãƒ¢ç”¨ã®èª¬æ˜ã‚’è¡¨ç¤º
            setTimeout(() => {
                if (gameState.isDemo) {
                    displayText = `
=== ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===

AIãŒæœˆé¢ç€é™¸ã‚’å®Ÿæ¼”ã—ã¾ã™ã€‚

é«˜åº¦ã¨é€Ÿåº¦ã‚’ç¢ºèªã—ãªãŒã‚‰ã€
é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ç‚¹ç«ã—ã€
å®‰å…¨ãªç€é™¸ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚

ã‚ãªãŸã‚‚æŒœæˆ¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼
                    `;
                    document.getElementById('gameArea').innerHTML = displayText;
                    startGame();
                }
            }, 1500);
        }
        
        // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰çµ‚äº†
        function stopDemo() {
            if (gameState.isDemo) {
                gameState.isDemo = false;
                document.getElementById('demoText').style.display = 'none';
            }
        }
        
        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
        document.addEventListener('keydown', function(event) {
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’è¨˜éŒ²
            gameState.lastUserInput = Date.now();
            
            // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ä¸­ã®å ´åˆã¯çµ‚äº†
            if (gameState.isDemo) {
                stopDemo();
            }
            
            if (event.key.toLowerCase() === 't') {
                thrust();
            }
        });
        
        // ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã¨ã—ã¦è¨˜éŒ²
        document.getElementById('thrustBtn').addEventListener('click', () => {
            gameState.lastUserInput = Date.now();
            if (gameState.isDemo) {
                stopDemo();
            }
        });
        
        document.getElementById('startBtn').addEventListener('click', () => {
            gameState.lastUserInput = Date.now();
            if (gameState.isDemo) {
                stopDemo();
            }
        });

        // ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹
        setInterval(gameLoop, 50); // 20 FPS
        
        // åˆæœŸåŒ–
        initGame();
        drawGame();
    </script>
</body>
</html>